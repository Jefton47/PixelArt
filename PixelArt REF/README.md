# 🎨 Pixelart Editor - ООП Рефакторинг

**Курсовая работа по рефакторингу процедурного кода в объектно-ориентированный**

Автор: Чернов Евгений  
Версия: 1.0.0  
Язык: Python 3.8+  
Библиотека: Pygame 2.0+

---

## 📋 Содержание

- [О проекте](#о-проекте)
- [Возможности](#возможности)
- [Архитектура](#архитектура)
- [Установка](#установка)
- [Использование](#использование)
- [Структура проекта](#структура-проекта)
- [Паттерны проектирования](#паттерны-проектирования)
- [Тестирование](#тестирование)
- [Горячие клавиши](#горячие-клавиши)

---

## 🎯 О проекте

Pixelart Editor — это графический редактор для создания пиксель-арта. Проект является результатом **полного рефакторинга** процедурного кода в чистую объектно-ориентированную архитектуру с применением лучших практик и паттернов проектирования.

### Цели рефакторинга:
- ✅ Переход от процедурного к ООП стилю
- ✅ Применение паттернов проектирования (MVC, Strategy, Singleton, Command, Observer)
- ✅ Разделение ответственности (Separation of Concerns)
- ✅ Повышение читаемости и поддерживаемости кода
- ✅ Модульная архитектура с четким разделением слоев

---

## ✨ Возможности

### Инструменты рисования:
- 🖌️ **Кисть** — рисование с регулируемым размером (1-5 пикселей)
- 🧹 **Ластик** — стирание с регулируемым размером (1-5 пикселей)
- 🪣 **Заливка** — заполнение области цветом (Flood Fill)
- 💧 **Пипетка** — выбор цвета с холста

### Возможности редактора:
- 🎨 Палитра из 96 тщательно подобранных цветов
- ↩️ Отмена/Повтор действий (Undo/Redo)
- 💾 Сохранение и загрузка проектов (.txt)
- 📤 Экспорт в PNG (768×768px)
- 🎚️ Слайдеры для настройки размера инструментов
- ⌨️ Полная поддержка горячих клавиш

### Параметры холста:
- Размер сетки: 64×64 пикселей
- Размер ячейки: 12×12 пикселей
- Итоговое разрешение при экспорте: 768×768px

---

## 🏗️ Архитектура

Проект построен по архитектурному паттерну **MVC (Model-View-Controller)** с четким разделением слоев:

```
┌─────────────────────────────────────────────────────────┐
│                    APPLICATION (Core)                    │
│                     Singleton Pattern                    │
└─────────────────────────────────────────────────────────┘
                            │
        ┌───────────────────┼───────────────────┐
        ▼                   ▼                   ▼
┌───────────────┐   ┌───────────────┐   ┌───────────────┐
│    MODELS     │   │ CONTROLLERS   │   │      UI       │
│   (Данные)    │   │   (Логика)    │   │  (Интерфейс)  │
└───────────────┘   └───────────────┘   └───────────────┘
        │                   │                   │
        ▼                   ▼                   ▼
┌───────────────┐   ┌───────────────┐   ┌───────────────┐
│   Grid/Cell   │   │ CanvasCtrl    │   │ Button/Slider │
│   Palette     │   │ InputCtrl     │   │ ColorPicker   │
│   History     │   │ FileCtrl      │   │               │
└───────────────┘   └───────────────┘   └───────────────┘
        │                   │
        └───────────────────┴───────────────────┐
                            ▼                   ▼
                    ┌───────────────┐   ┌───────────────┐
                    │     TOOLS     │   │     UTILS     │
                    │   (Strategy)  │   │  (Helpers)    │
                    └───────────────┘   └───────────────┘
                            │                   │
                            ▼                   ▼
                    ┌───────────────┐   ┌───────────────┐
                    │ Brush/Eraser  │   │   Vector2D    │
                    │ Fill/Dropper  │   │   Math Utils  │
                    └───────────────┘   └───────────────┘
```

---

## 🔧 Установка

### Требования:
- Python 3.8 или выше
- pip (менеджер пакетов Python)

### Шаг 1: Клонирование репозитория
```bash
git clone <repository-url>
cd pixelart-editor
```

### Шаг 2: Установка зависимостей
```bash
pip install pygame
```

### Шаг 3: Подготовка ресурсов
Создайте папку `assets/` и поместите туда иконки:
```
assets/
├── icon.png        # Иконка окна
├── brush.png       # Иконка кисти (22×22)
├── eraser.png      # Иконка ластика (22×22)
├── fill.png        # Иконка заливки (22×22)
└── eyedropper.png  # Иконка пипетки (22×22)
```

> **Примечание:** Если иконки отсутствуют, приложение запустится с текстовыми кнопками.

### Шаг 4: Запуск
```bash
python main.py
```

---

## 🎮 Использование

### Основной workflow:
1. **Выберите инструмент** — кликом по кнопке или горячей клавишей (B/E/G/I)
2. **Выберите цвет** — кликом по палитре
3. **Настройте размер** — перетаскиванием слайдера
4. **Рисуйте** — кликом и перетаскиванием по холсту
5. **Сохраните** — Ctrl+S или кнопка "Save"
6. **Экспортируйте** — кнопка "Export" для получения PNG

### Работа с проектами:
```
Save   → Сохранение в .txt (текстовый формат)
Load   → Загрузка из .txt
Export → Экспорт в .png (только изображение)
```

---

## 📁 Структура проекта

```
pixelart-editor/
├── main.py                 # Точка входа в приложение
├── README.md               # Документация
├── test_complete.py        # Полный тест системы
│
├── core/                   # Ядро приложения
│   ├── __init__.py
│   ├── application.py      # Главный класс (Singleton)
│   └── config.py           # Конфигурация
│
├── models/                 # Модели данных
│   ├── __init__.py
│   ├── cell.py             # Ячейка холста
│   ├── grid.py             # Сетка холста
│   ├── palette.py          # Цветовая палитра
│   └── history.py          # История для Undo/Redo
│
├── tools/                  # Инструменты рисования
│   ├── __init__.py
│   ├── base_tool.py        # Базовый класс инструмента
│   ├── brush_tool.py       # Кисть
│   ├── eraser_tool.py      # Ластик
│   ├── fill_tool.py        # Заливка
│   ├── eyedropper_tool.py  # Пипетка
│   └── tool_manager.py     # Менеджер инструментов
│
├── ui/                     # UI компоненты
│   ├── __init__.py
│   ├── button.py           # Кнопка
│   ├── slider.py           # Слайдер
│   ├── color_picker.py     # Палитра цветов
│   └── toolbar.py          # Панель инструментов
│
├── controllers/            # Контроллеры логики
│   ├── __init__.py
│   ├── input_controller.py     # Обработка ввода
│   ├── file_controller.py      # Работа с файлами
│   └── canvas_controller.py    # Управление холстом
│
├── utils/                  # Утилиты
│   ├── __init__.py
│   ├── vector2d.py         # 2D вектор
│   ├── math_utils.py       # Математические функции
│   └── file_utils.py       # Работа с файлами
│
└── assets/                 # Ресурсы (иконки)
    ├── icon.png
    ├── brush.png
    ├── eraser.png
    ├── fill.png
    └── eyedropper.png
```

---

## 🎨 Паттерны проектирования

### 1. **MVC (Model-View-Controller)**
Разделение данных, логики и представления:
- **Model** (`models/`) — хранение данных (Grid, Cell, Palette)
- **View** (`ui/`) — отображение интерфейса (Button, Slider)
- **Controller** (`controllers/`) — бизнес-логика (Canvas, Input, File)

### 2. **Strategy**
Инструменты (`tools/`) реализуют единый интерфейс `Tool`:
```python
class Tool(ABC):
    @abstractmethod
    def use(self, grid, x, y, color):
        pass
```
Это позволяет легко добавлять новые инструменты без изменения существующего кода.

### 3. **Singleton**
Класс `Application` существует в единственном экземпляре:
```python
class Application:
    _instance = None
    
    def __new__(cls):
        if cls._instance is None:
            cls._instance = super().__new__(cls)
        return cls._instance
```

### 4. **Command**
История действий (`History`) сохраняет состояния для Undo/Redo:
```python
class History:
    def save_state(self): ...
    def undo(self): ...
    def redo(self): ...
```

### 5. **Observer** (частично)
UI компоненты имеют callback'и для реакции на события:
```python
button.set_on_click(lambda: self.save_file())
```

---

## 🧪 Тестирование

Проект включает полный набор тестов для проверки всех компонентов:

```bash
python test_complete.py
```

### Что тестируется:
- ✅ Импорт всех модулей (23 модуля)
- ✅ Модели данных (Cell, Grid, Palette, History)
- ✅ Инструменты (Brush, Eraser, Fill, EyeDropper)
- ✅ UI компоненты (Button, Slider, ColorPicker)
- ✅ Контроллеры (Input, Canvas, File)
- ✅ Конфигурация (Config)
- ✅ Интеграция (совместная работа всех компонентов)

### Пример вывода:
```
╔══════════════════════════════════════════════════════════╗
║          ПОЛНОЕ ТЕСТИРОВАНИЕ PIXELART EDITOR             ║
╚══════════════════════════════════════════════════════════╝

ТЕСТ 1: Импорт модулей
✓ pygame
✓ models.cell
✓ models.grid
...

ИТОГИ ТЕСТИРОВАНИЯ
Импорт модулей                ✅ PASSED
Модели данных                 ✅ PASSED
Инструменты                   ✅ PASSED
UI компоненты                 ✅ PASSED
Контроллеры                   ✅ PASSED
Конфигурация                  ✅ PASSED
Интеграция                    ✅ PASSED

Результат: 7/7 тестов пройдено
🎉 ВСЕ ТЕСТЫ ПРОЙДЕНЫ! СИСТЕМА РАБОТАЕТ!
```

---

## ⌨️ Горячие клавиши

### Инструменты:
| Клавиша | Действие |
|---------|----------|
| `B` | Выбрать Кисть (Brush) |
| `E` | Выбрать Ластик (Eraser) |
| `G` | Выбрать Заливку (Fill) |
| `I` | Выбрать Пипетку (Eyedropper) |

### Файлы:
| Комбинация | Действие |
|------------|----------|
| `Ctrl + S` | Быстрое сохранение |
| Кнопка `Save` | Сохранить проект (.txt) |
| Кнопка `Load` | Загрузить проект (.txt) |
| Кнопка `Export` | Экспорт в PNG |

### Редактирование:
| Комбинация | Действие |
|------------|----------|
| `Ctrl + Z` | Отменить (Undo) |
| `Ctrl + Y` | Повторить (Redo) |
| `Ctrl + Space` | Очистить холст |

### Рисование:
| Действие | Описание |
|----------|----------|
| ЛКМ (зажатие) | Рисовать выбранным инструментом |
| ПКМ | Клик по цвету в палитре для выбора |

---

## 📊 Технические характеристики

### Производительность:
- **FPS:** 60 (стабильно)
- **Размер сетки:** 64×64 = 4096 ячеек
- **Потребление памяти:** ~50-80 MB
- **Время отклика UI:** <16ms

### Форматы файлов:
- **Проект (.txt):** Текстовый формат, хранит RGB значения каждой ячейки
- **Экспорт (.png):** Растровое изображение 768×768px

### Палитра:
- **Количество цветов:** 96
- **Категории:**
  - Оттенки серого (8)
  - Синие тона (16)
  - Серо-синие тона (8)
  - Серебристые тона (8)
  - Красные тона (16)
  - Фиолетовые тона (8)
  - Синие глубокие (8)
  - Зеленые тона (8)
  - Желтые тона (8)
  - Оранжевые тона (8)

---

## 🔮 Планы развития

### Версия 1.1:
- [ ] Поддержка слоев (Layers)
- [ ] Дополнительные инструменты (линия, прямоугольник, круг)
- [ ] Пользовательские палитры
- [ ] Градиенты

### Версия 1.2:
- [ ] Анимация (спрайтлисты)
- [ ] Экспорт в GIF
- [ ] Автосохранение
- [ ] История изменений (расширенная)

### Версия 2.0:
- [ ] Плагинная система
- [ ] Скриптинг (Python API)
- [ ] Совместная работа (сеть)
- [ ] Экспорт в различные форматы (SVG, JSON)

---

## 👨‍💻 Автор

**Чернов Евгений**  
Курсовая работа по рефакторингу  
2024 год

---

## 📄 Лицензия

Проект создан в образовательных целях.  
Свободное использование для обучения и некоммерческих проектов.

---

## 🙏 Благодарности

- **Pygame Community** — за отличную библиотеку
- **Design Patterns** (Gang of Four) — за архитектурные паттерны
- **Clean Code** (Robert Martin) — за принципы чистого кода

---

## 📞 Контакты

Если у вас есть вопросы или предложения по проекту:
- Создайте Issue в репозитории
- Или свяжитесь напрямую

---

**Создано с ❤️ в рамках изучения ООП и паттернов проектирования**