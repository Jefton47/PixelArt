#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Pixelart Editor - ĞĞĞŸ Ğ ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³
ĞšÑƒÑ€ÑĞ¾Ğ²Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°: Ğ ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¿Ñ€Ğ¾Ñ†ĞµĞ´ÑƒÑ€Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´Ğ° Ğº ĞĞĞŸ
ĞĞ²Ñ‚Ğ¾Ñ€: Ğ§ĞµÑ€Ğ½Ğ¾Ğ² Ğ•Ğ²Ğ³ĞµĞ½Ğ¸Ğ¹
Ğ’ĞµÑ€ÑĞ¸Ñ: 1.0.0
"""

import sys
import os

# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ñ‚ĞµĞºÑƒÑ‰ÑƒÑ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ² Ğ¿ÑƒÑ‚ÑŒ (Ğ½Ğ° Ğ²ÑÑĞºĞ¸Ğ¹ ÑĞ»ÑƒÑ‡Ğ°Ğ¹)
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))

from core import Application, Config


def print_banner():
    """Ğ’Ñ‹Ğ²ĞµÑÑ‚Ğ¸ Ğ±Ğ°Ğ½Ğ½ĞµÑ€ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ"""
    print("=" * 60)
    print("         PIXELART EDITOR - ĞĞĞŸ Ğ Ğ•Ğ¤ĞĞšĞ¢ĞĞ Ğ˜ĞĞ“")
    print("=" * 60)
    print(f"Ğ Ğ°Ğ·Ğ¼ĞµÑ€ ÑĞµÑ‚ĞºĞ¸: {Config.GRID_WIDTH}x{Config.GRID_HEIGHT}")
    print(f"Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¾ĞºĞ½Ğ°: {Config.SCREEN_WIDTH}x{Config.SCREEN_HEIGHT}")
    print(f"FPS: {Config.FPS}")
    print("=" * 60)
    print()


def print_controls():
    """Ğ’Ñ‹Ğ²ĞµÑÑ‚Ğ¸ ÑĞ¿Ñ€Ğ°Ğ²ĞºÑƒ Ğ¿Ğ¾ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ"""
    print("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    print("â•‘              Ğ£ĞŸĞ ĞĞ’Ğ›Ğ•ĞĞ˜Ğ• Ğ˜ Ğ“ĞĞ Ğ¯Ğ§Ğ˜Ğ• ĞšĞ›ĞĞ’Ğ˜Ğ¨Ğ˜              â•‘")
    print("â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")
    print("â•‘ Ğ˜ĞĞ¡Ğ¢Ğ Ğ£ĞœĞ•ĞĞ¢Ğ«:                                           â•‘")
    print("â•‘   B         - ĞšĞ¸ÑÑ‚ÑŒ (Brush)                            â•‘")
    print("â•‘   E         - Ğ›Ğ°ÑÑ‚Ğ¸Ğº (Eraser)                          â•‘")
    print("â•‘   G         - Ğ—Ğ°Ğ»Ğ¸Ğ²ĞºĞ° (Fill)                           â•‘")
    print("â•‘   I         - ĞŸĞ¸Ğ¿ĞµÑ‚ĞºĞ° (Eyedropper)                     â•‘")
    print("â•‘                                                        â•‘")
    print("â•‘ Ğ¤ĞĞ™Ğ›Ğ«:                                                 â•‘")
    print("â•‘   Ctrl+S    - Ğ‘Ñ‹ÑÑ‚Ñ€Ğ¾Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ                       â•‘")
    print("â•‘   Save      - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ (.txt)                  â•‘")
    print("â•‘   Load      - Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ (.txt)                  â•‘")
    print("â•‘   Export    - Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ² PNG                            â•‘")
    print("â•‘                                                        â•‘")
    print("â•‘ Ğ Ğ•Ğ”ĞĞšĞ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ•:                                        â•‘")
    print("â•‘   Ctrl+Z    - ĞÑ‚Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ (Undo)                          â•‘")
    print("â•‘   Ctrl+Y    - ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚ÑŒ (Redo)                         â•‘")
    print("â•‘   Ctrl+Space- ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ Ñ…Ğ¾Ğ»ÑÑ‚                           â•‘")
    print("â•‘                                                        â•‘")
    print("â•‘ ĞŸĞĞ›Ğ˜Ğ¢Ğ Ğ«:                                               â•‘")
    print("â•‘   1         - ĞŸĞ°Ğ»Ğ¸Ñ‚Ñ€Ğ° 'ĞĞ±Ğ»Ğ¸Ğº' (96 Ñ†Ğ²ĞµÑ‚Ğ¾Ğ²)              â•‘")
    print("â•‘   2         - ĞŸĞ°Ğ»Ğ¸Ñ‚Ñ€Ğ° 'ĞœÑĞ³ĞºĞ¸Ğµ Ğ¾Ñ‚Ñ‚ĞµĞ½ĞºĞ¸' (30 Ñ†Ğ²ĞµÑ‚Ğ¾Ğ²)     â•‘")
    print("â•‘                                                        â•‘")
    print("â•‘ Ğ ĞĞ—ĞœĞ•Ğ Ğ«:                                               â•‘")
    print("â•‘   Ğ¡Ğ»Ğ°Ğ¹Ğ´ĞµÑ€   - Ğ ĞµĞ³ÑƒĞ»Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° ĞºĞ¸ÑÑ‚Ğ¸/Ğ»Ğ°ÑÑ‚Ğ¸ĞºĞ° (1-5)  â•‘")
    print("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    print()


def print_architecture():
    """Ğ’Ñ‹Ğ²ĞµÑÑ‚Ğ¸ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ± Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğµ"""
    print("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    print("â•‘              ĞĞ Ğ¥Ğ˜Ğ¢Ğ•ĞšĞ¢Ğ£Ğ Ğ ĞŸĞ Ğ˜Ğ›ĞĞ–Ğ•ĞĞ˜Ğ¯ (ĞĞĞŸ)              â•‘")
    print("â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")
    print("â•‘ ĞŸĞĞ¢Ğ¢Ğ•Ğ ĞĞ« ĞŸĞ ĞĞ•ĞšĞ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ¯:                               â•‘")
    print("â•‘   â€¢ MVC (Model-View-Controller)                        â•‘")
    print("â•‘   â€¢ Strategy (Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ñ€Ğ¸ÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ñ)                   â•‘")
    print("â•‘   â€¢ Singleton (Application)                            â•‘")
    print("â•‘   â€¢ Command (Undo/Redo)                                â•‘")
    print("â•‘   â€¢ Observer (Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ)                                 â•‘")
    print("â•‘                                                        â•‘")
    print("â•‘ Ğ¡Ğ¢Ğ Ğ£ĞšĞ¢Ğ£Ğ Ğ ĞœĞĞ”Ğ£Ğ›Ğ•Ğ™:                                     â•‘")
    print("â•‘   models/      - ĞœĞ¾Ğ´ĞµĞ»Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (Grid, Cell, Palette)  â•‘")
    print("â•‘   utils/       - Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹ (Vector2D, math, files)       â•‘")
    print("â•‘   tools/       - Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ (Brush, Eraser, Fill)     â•‘")
    print("â•‘   ui/          - UI ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ (Button, Slider)        â•‘")
    print("â•‘   controllers/ - ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ñ‹ (Input, File, Canvas)    â•‘")
    print("â•‘   core/        - Ğ¯Ğ´Ñ€Ğ¾ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ (Application)         â•‘")
    print("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    print()


def check_dependencies():
    """ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ñ‹Ñ… Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹"""
    print("ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹...")
    
    try:
        import pygame
        print(f"âœ“ Pygame {pygame.version.ver} ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½")
    except ImportError:
        print("âœ— Pygame Ğ½Ğµ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½!")
        print("  Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ: pip install pygame")
        return False
    
    # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
    modules = ['models', 'utils', 'tools', 'ui', 'controllers', 'core']
    for module in modules:
        try:
            __import__(module)
            print(f"âœ“ ĞœĞ¾Ğ´ÑƒĞ»ÑŒ {module} Ğ½Ğ°Ğ¹Ğ´ĞµĞ½")
        except ImportError as e:
            print(f"âœ— ĞœĞ¾Ğ´ÑƒĞ»ÑŒ {module} Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½!")
            print(f"  ĞÑˆĞ¸Ğ±ĞºĞ°: {e}")
            return False
    
    print("âœ“ Ğ’ÑĞµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ½Ğ° Ğ¼ĞµÑÑ‚Ğµ!\n")
    return True


def main():
    """Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ"""
    
    # Ğ‘Ğ°Ğ½Ğ½ĞµÑ€
    print_banner()
    
    # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹
    if not check_dependencies():
        print("\nâŒ ĞĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ - Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒÑÑ‚ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸")
        sys.exit(1)
    
    # Ğ¡Ğ¿Ñ€Ğ°Ğ²ĞºĞ°
    print_controls()
    print_architecture()
    
    # Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
    try:
        print("ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ...")
        print("   ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ctrl+C Ğ´Ğ»Ñ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ°\n")
        
        app = Application()
        app.run()
        
    except KeyboardInterrupt:
        print("\n\nâš ï¸  ĞŸÑ€ĞµÑ€Ğ²Ğ°Ğ½Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼ (Ctrl+C)")
        sys.exit(0)
    
    except Exception as e:
        print(f"\n\nâŒ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°: {e}")
        import traceback
        traceback.print_exc()
        sys.exit(1)


if __name__ == "__main__":
    main()